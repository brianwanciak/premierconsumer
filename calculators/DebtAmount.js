KJE.DebtCalculation=function(){this.MSG_ERROR1=KJE.parameters.get("MSG_ERROR1","Rate must be at least 0.00%.");this.MSG_ERROR2=KJE.parameters.get("MSG_ERROR2","Term must be greater than zero.");this.MSG_ERROR3=KJE.parameters.get("MSG_ERROR3","Payment must be greater than zero.");this.MSG_ERROR4=KJE.parameters.get("MSG_ERROR4","Calculated loan balance is less than zero.");this.MSG_ERROR8=KJE.parameters.get("MSG_ERROR8","Calculated remaining payments exceeds 480 months.");this.MSG_ERROR6=KJE.parameters.get("MSG_ERROR6","Balance must be greater than zero.");this.MSG_ERROR7=KJE.parameters.get("MSG_ERROR7","Calculated loan payment exceeds $500,000.");this.MSG_ERROR9=KJE.parameters.get("MSG_ERROR9","Loan balance must be at least KJE1.");this.MSG_PAYOFF_30=KJE.parameters.get("MSG_PAYOFF_30","more than 30 years");this.MSG_TITLE1=KJE.parameters.get("MSG_TITLE1","Your plan could save you KJE1 in interest.");this.MSG_TITLE2=KJE.parameters.get("MSG_TITLE2","Your plan could cost you KJE1 in additional interest.");this.MSG_TITLE_AMOUNT=KJE.parameters.get("MSG_TITLE_AMOUNT","You owe a total of KJE1.");this.MSG_TITLE_INVEST=KJE.parameters.get("MSG_TITLE_INVEST","Your investment could be worth KJE1 after KJE2 years.");this.MSG_LESS=KJE.parameters.get("MSG_LESS","less");this.MSG_MORE=KJE.parameters.get("MSG_MORE","more");this.LOAN_CURRENT_CALC_PAYMENT=KJE.parameters.get("LOAN_CURRENT_CALC_PAYMENT",false);this.CALCULATE_LOAN_AMOUNT=KJE.parameters.get("CALCULATE_LOAN_AMOUNT",true);this.bInterestOnly=false;this.CANADIAN=KJE.parameters.get("CANADIAN",false);this.MORTGAGE_CONSOLIDATE=KJE.parameters.get("MORTGAGE_CONSOLIDATE",false);this.CALC_INVESTMENT=KJE.parameters.get("CALC_INVESTMENT",false);this.USE_LOAN_TYPE=KJE.parameters.get("USE_LOAN_TYPE",true);this.SHOW_TAXES=KJE.parameters.get("SHOW_TAXES",false);this.d30_LOAN_TERM=KJE.parameters.get("30_LOAN_TERM",0);this.d30_LOAN_RATE=KJE.parameters.get("30_LOAN_RATE",0);this.FORCE_CALC=true;this.FIRST_YEARS_INTEREST=0;this.CALC_ACCEL=KJE.parameters.get("CALC_ACCEL",false);this.CALC_AMOUNT=1;this.CALC_RATE=2;this.CALC_TERM=3;this.CALC_PAYMENT=4;this.LAST_CHANGED=this.CALC_AMOUNT;this.oNEW_LOAN_PAYMENT=0;this.CC_MIN=15;this.CC_USE_MINIMUM=false;this.ACCELERATE_BALANCE=0;this.LOAN_TERM_LABEL="";this.CC_MONTHLY_PAYMENT=0;this.CC_AVERAGE_RATE=0;this.CC_OUTSTANDING_BALANCE=0;this.INCOME_TAX_RATE=0;this.NEW_LOAN_BALANCE=0;this.NEW_LOAN_RATE=0;this.NEW_LOAN_PAYMENT=0;this.NEW_LOAN_TERM=0;this.OLD_OUTSTANDING_BALANCE=0;this.AVAIL_MARGIN=0;this.ACC_LOAN_PAYMENT=0;this.CURRENT_PAYOFF="";this.CURRENT_PAYOFF_MONTHS=0;this.NEW_PAYOFF="";this.ACCEL_PAYOFF="";this._iCCCount=0;this._iLNCount=0;this._iALCount=0;this.bFrance=false;this.AVAIL_MARGIN_CALC=true;this.AMOUNT_ONLY=KJE.parameters.get("AMOUNT_ONLY",false);this.TAX_SAVINGS=0;this.DS_PAYMENT_CATS=[KJE.parameters.get("MSG_PAYMENT_CATS1","Current")+" ",KJE.parameters.get("MSG_PAYMENT_CATS2","Consolidated")+" "];if(this.CALC_ACCEL){this.DS_PAYMENT_CATS[2]=KJE.parameters.get("MSG_PAYMENT_CATS3","Accelerated")+" "}this.INVESTMENT_PERCENT=0;this.RETURN_PERCENT=0;this.NEW_LOAN_FEES=0;this.NET_CASH=0;this.AVAIL_MARGIN=0;this.sSchedule=new KJE.Repeating()};KJE.DebtCalculation.prototype.clear=function(){};KJE.DebtCalculation.prototype.calculate=function(e){var X=KJE;if(this.MORTGAGE_CONSOLIDATE&&this.USE_LOAN_TYPE){this.NEW_LOAN_TERM=KJE.DebtCalculation.dProductTerm[this.LOAN_TYPE_INDEX];this.bInterestOnly=KJE.DebtCalculation.dProductIO[this.LOAN_TYPE_INDEX];var ak=true}else{this.LOAN_TERM_LABEL=KJE.DebtCalculation.sProductList[this.LOAN_TYPE_INDEX];var ak=KJE.DebtCalculation.dProductMortgage[this.LOAN_TYPE_INDEX]}var D=0;var l=0;var F=0;var c=0;var r=0;var aB=0;var I=0;var b=0;var ay=0;var W=0;var o=0;var at=0;var aK=0;var a=this.CC_USE_MINIMUM;var aq=this.CC_MIN;var E=this.CC_BALANCE;var av=this.CC_RATE;var f=this.CC_PAYMENT;var x=this.CC_OLD;var ax=this.LOAN_CURRENT_BALANCE;var ad=this.LOAN_PAYMENT;var t=this.LOAN_INTEREST_RATE;var O=this.LOAN_MONTHS_LEFT;var ae=this.ccBal;var z=this.loanBal;var N=0;var Q=0;var H=0;var G=0;var aJ=0;for(N=0;N<this._iCCCount;N++){if(((x[N]!=E[N]+av[N])||a)&&(this.FORCE_CALC)){f[N]=this.CCPayment(true,E[N],f[N],aq);H=X.round(E[N]*(av[N]/1200),2);if(f[N]>(E[N]+H)){f[N]=(E[N]+H)}x[N]=E[N]+av[N]}}for(Q=0;Q<this._iLNCount;Q++){if(ad[Q]>0||ax[Q]>0){if(this.LOAN_CURRENT_CALC_PAYMENT){ad[Q]=KJE.PMT(t[Q]/1200,O[Q],ax[Q]);if(ad[Q]>500000){throw (this.MSG_ERROR7)}}else{O[Q]=KJE.PERIODS(t[Q]/1200,ad[Q],ax[Q]);if(O[Q]>500){throw (this.MSG_ERROR8)}}}if(ax[Q]>0){D+=ad[Q]}l+=ax[Q]*t[Q];if(Q<this._iALCount){if(ax[Q]>0){I+=ad[Q]}ay+=ax[Q];b+=ax[Q]*t[Q]}else{if(ax[Q]>0){W+=ad[Q]}at+=ax[Q];o+=ax[Q]*t[Q]}}for(Q=0;Q<this._iCCCount;Q++){if(E[Q]>0){D+=f[Q]}l+=E[Q]*av[Q];if(E[Q]>0){r+=f[Q]}c+=E[Q];aB+=E[Q]*av[Q]}F+=c+ay+at;if(aB>0&&c>0){aB=(aB/100)/c}else{aB=0}if(l>0&&F>0){l=(l/100)/F}else{l=0}if(b>0&&ay>0){b=(b/100)/ay}else{b=0}if(o>0&&at>0){o=(o/100)/at}else{o=0}var al=this.NEW_LOAN_PAYMENT;var aG=this.NEW_LOAN_BALANCE;this.LAST_CHANGED=this.CALC_AMOUNT;if(F!=this.OLD_OUTSTANDING_BALANCE){aG=F+this.NEW_LOAN_FEES;this.LAST_CHANGED=this.CALC_AMOUNT}else{if(this.oNEW_LOAN_PAYMENT!=al){this.LAST_CHANGED=this.CALC_PAYMENT}}var am=this.NEW_LOAN_RATE/1200;if(this.CANADIAN&&ak){am=(Math.pow(1+(this.NEW_LOAN_RATE/200),1/6)-1)}if(this.NEW_LOAN_RATE<0){throw (this.MSG_ERROR1)}if(this.NEW_LOAN_TERM<=0){throw (this.MSG_ERROR2)}if(this.LAST_CHANGED==this.CALC_PAYMENT){if(al<=0){throw (this.MSG_ERROR3)}if(this.bInterestOnly){aG=X.round(al/(am),2)}else{if(this.CALCULATE_LOAN_AMOUNT){aG=X.round(KJE.PV(am,this.NEW_LOAN_TERM,al),2);if(aG<0){throw (this.MSG_ERROR4)}if(aG>=10000000){throw (this.MSG_ERROR5)}}else{this.NEW_LOAN_TERM=Math.ceil(KJE.PERIODS(am,al,aG))}}}else{if(aG<0){throw (this.MSG_ERROR6)}if(this.bInterestOnly){al=X.round((am)*aG,2)}else{al=X.round(KJE.PMT(am,this.NEW_LOAN_TERM,aG),2)}if(al>=500000){throw (this.MSG_ERROR7)}}if(!this.AMOUNT_ONLY){if(Math.round(aG)<(Math.round(F+this.NEW_LOAN_FEES))){throw (KJE.getKJEReplaced(this.MSG_ERROR9,X.dollars(F+this.NEW_LOAN_FEES)))}}this.oNEW_LOAN_PAYMENT=X.round(al,2);var aC=1;if(!this.AMOUNT_ONLY){aC++;if(this.CALC_ACCEL&&!this.CALC_INVESTMENT){aC++;this.AVAIL_MARGIN=((D-al)<0?0:D-al);if(this.AVAIL_MARGIN>100000){this.AVAIL_MARGIN=100000}if(this.OLD_AVAIL_MARGIN!=this.AVAIL_MARGIN&&this.AVAIL_MARGIN_CALC){this.ACCELERATE_BALANCE=this.AVAIL_MARGIN;this.OLD_AVAIL_MARGIN=this.AVAIL_MARGIN}this.ACC_LOAN_PAYMENT=al+this.ACCELERATE_BALANCE}}else{this.AVAIL_MARGIN=0;this.ACC_LOAN_PAYMENT=al}if(this.CALC_INVESTMENT){this.NET_CASH=Math.round(aG-F-this.NEW_LOAN_FEES);this.NET_CASH=(this.NET_CASH<=0?0:this.NET_CASH);this.AVAIL_MARGIN=((D-al)<0?0:D-al);if(this.INVESTMENT_PERCENT==0){this.ACCELERATE_BALANCE=this.AVAIL_MARGIN}else{this.ACCELERATE_BALANCE=(this.INVESTMENT_PERCENT==100?0:Math.round(this.AVAIL_MARGIN*(1-this.INVESTMENT_PERCENT/100)))}this.ACC_LOAN_PAYMENT=al+this.ACCELERATE_BALANCE;this.ACC_INVESTMENT_AMT=this.AVAIL_MARGIN-this.ACCELERATE_BALANCE}var an=this.DS_PAYMENTS=new Array(aC);var ar=this.DS_PAYMENTS_BLD=new Array(aC);var af=this.DS_INTEREST=new Array(aC);var v=this.DS_INTEREST_BLD=new Array(aC);var j=this.DS_MONTHS=new Array(aC);var aL=this.DS_MONTHS_BLD=new Array(aC);var U=Math.round(this.NEW_LOAN_TERM);var ag=0;var ap=U;var S=0;var aw=this.DR_BALANCE=KJE.FloatArray(U);var ai=this.DR_PRINCIPAL=KJE.FloatArray(U);var g=this.DR_INTEREST=KJE.FloatArray(U);var p=this.DR_NEW_BALANCE=KJE.FloatArray(U);var aD=this.DR_NEW_PRINCIPAL=KJE.FloatArray(U);var B=this.DR_NEW_INTEREST=KJE.FloatArray(U);if(this.CALC_ACCEL){var ah=this.DR_ACCEL_BALANCE=KJE.FloatArray(U);var K=this.DR_ACCEL_PRINCIPAL=KJE.FloatArray(U);var aA=this.DR_ACCEL_INTEREST=KJE.FloatArray(U)}if(this.CALC_INVESTMENT){var T=this.DR_INVEST_PAYMENTS=KJE.FloatArray(U);var L=this.DR_INVEST_INTEREST=KJE.FloatArray(U);var k=this.DR_INVEST_BALANCE=KJE.FloatArray(U)}var Y=0;var V=0;var au=0;var aa=F;var aF=0;var J=0;var w=aG;var h=0;var Z=0;var aj=aG;var az=0;var R=KJE.ROR_MONTH(this.RETURN_PERCENT/100);var d=KJE.DebtCalculation.MAXIMUM_TERM;for(Q=0;(Q<d+1);Q++){if(aa<=0&&Q>U){break}aa=0;if(Q<U){aF=X.round(w*(am),2);J=al-aF;if(w<J){J=w;w=0}else{w-=J}if(U-1==Q){if(w>0.005){J+=w;w=0}else{w=0}}p[Q]=w;B[Q]=aF;aD[Q]=J;V+=aF;if(this.CALC_ACCEL){h=X.round(aj*(am),2);Z=this.ACC_LOAN_PAYMENT-h;aj-=Z;az=0;if(aj<0){az=aj*-1;Z+=aj;aj=0}ah[Q]=aj;aA[Q]=h;K[Q]=Z;if(ah[Q]<=0){ah[Q]=0;if(ap==U){ap=Q+1}}else{au+=h}if(this.CALC_INVESTMENT){T[Q]=this.ACC_INVESTMENT_AMT+az;L[Q]=R*(Q==0?this.NET_CASH:k[Q-1]);aK=k[Q]=L[Q]+(Q==0?this.NET_CASH:k[Q-1])+T[Q]}}}for(N=0;N<this._iCCCount;N++){if(f[N]>0){if(Q==0){ae[N]=E[N]}H=X.round(ae[N]*(av[N]/1200),2);G=this.CCPayment(a,ae[N],f[N],aq);aJ=((G-H)>ae[N]?ae[N]:G-H);Y+=H;ae[N]-=aJ;if(Q<U){aw[Q]+=ae[N];g[Q]+=H;ai[Q]+=aJ}aa+=ae[N]}}for(N=0;N<this._iLNCount;N++){if(ad[N]>0&&ax[N]==0){throw (this.MSG_ERROR6)}if(ad[N]==0&&ax[N]>0){throw (this.MSG_ERROR3)}if(ad[N]>0||ax[N]>0){if(Q==0){z[N]=ax[N]}H=X.round(z[N]*(t[N]/1200),2);aJ=((ad[N]-H)>z[N]?z[N]:ad[N]-H);Y+=X.round(z[N]*(t[N]/1200),2);z[N]-=aJ;if(Q<U){aw[Q]+=z[N];g[Q]+=H;ai[Q]+=aJ}aa+=z[N]}}if(aa<=0&&ag==0){ag=Q+1}}if(ag==0){ag=KJE.DebtCalculation.MAXIMUM_TERM;this.CURRENT_PAYOFF=this.MSG_PAYOFF_30}else{this.CURRENT_PAYOFF=KJE.getTermLabel(ag,false)}this.CURRENT_PAYOFF_MONTHS=ag;this.NEW_PAYOFF=KJE.getTermLabel(U,false);this.ACCEL_PAYOFF=KJE.getTermLabel(ap,false);an[0]=(D);ar[0]=X.dollars(D);af[0]=(Y);v[0]=X.dollars(Y);j[0]=ag;aL[0]=X.number(ag)+" "+KJE.MSG_MONTHS_LBL;if(ag==KJE.DebtCalculation.MAXIMUM_TERM){aL[0]=" > "+aL[0]}if(!this.AMOUNT_ONLY){af[1]=(V);v[1]=X.dollars(V);ar[1]=X.dollars(al);an[1]=al;j[1]=U;aL[1]=X.number(U)+" "+KJE.MSG_MONTHS_LBL;if(this.CALC_ACCEL){v[2]=X.dollars(au);af[2]=(au);ar[2]=X.dollars(this.ACC_LOAN_PAYMENT);an[2]=(this.ACC_LOAN_PAYMENT);j[2]=ap;aL[2]=X.number(ap)+" "+KJE.MSG_MONTHS_LBL}}if(e){var aI=this.sSchedule;if(this.CALC_INVESTMENT){aI.clearRepeat();aI.addHeader({sCell:KJE._sHeadingUnderline,sContent:(aI.sReportCol("Planned loan payment of",5)+" "+X.dollars(this.ACC_LOAN_PAYMENT,2)+aI.sReportCol("",6)),sFormat:"colspan=4"},{sCell:KJE._sHeadingUnderline,sContent:aI.sReportCol("Investment Balance",7),sFormat:"colspan=3"});aI.addHeader("&nbsp;",aI.sReportCol("Payment",1),aI.sReportCol("Interest",2),aI.sReportCol("Balance",3),aI.sReportCol("Investment Contributions",1),aI.sReportCol("Interest",2),aI.sReportCol("Balance",3));aI.addRepeat("&nbsp;","&nbsp;","&nbsp;",X.dollars(aG,2),"&nbsp;","&nbsp;",X.dollars(this.NET_CASH,2))}else{if(this.CALC_ACCEL){aI.clearRepeat();aI.addHeader({sCell:KJE._sHeadingUnderline,sContent:(aI.sReportCol("Consolidated loan payment of",5)+" "+X.dollars(al,2)+aI.sReportCol("",6)),sFormat:"colspan=4"},{sCell:KJE._sHeadingUnderline,sContent:(aI.sReportCol("Accelerated payment of",7)+" "+X.dollars(this.ACC_LOAN_PAYMENT,2)+aI.sReportCol("",8)),sFormat:"colspan=3"});aI.addHeader("&nbsp;",aI.sReportCol("Interest",1),aI.sReportCol("Principal",2),aI.sReportCol("Balance",3),aI.sReportCol("Interest",1),aI.sReportCol("Principal",2),aI.sReportCol("Balance",3));aI.addRepeat("&nbsp;","&nbsp;","&nbsp;",X.dollars(aG,2),"&nbsp;","&nbsp;",X.dollars(aG,2))}else{aI.addHeader("&nbsp;",aI.sReportCol("Interest",1),aI.sReportCol("Principal",2),aI.sReportCol("Payment",4),aI.sReportCol("Balance",3));aI.addRepeat("&nbsp;","&nbsp;","&nbsp;","&nbsp;",X.dollars(aG,2))}}}var M=0;U=(this.AMOUNT_ONLY?ag:U);var A=1;if(U>=120){A=12}this.FIRST_YEARS_INTEREST=0;for(var P=0;P<12&&P<B.length;P++){this.FIRST_YEARS_INTEREST+=B[P]}this.TAX_SAVINGS=(this.SHOW_TAXES&&ak&&!this.CANADIAN?X.round(this.FIRST_YEARS_INTEREST*(this.INCOME_TAX_RATE/100),2):0);var aE=Math.ceil(U/A+1);var m=this.cats=new Array(aE);var C=this.DS_BALANCE=KJE.FloatArray(aE);var ab=this.DS_NEW_BALANCE=KJE.FloatArray(aE);if(this.CALC_ACCEL){var s=this.DS_ACCEL_BALANCE=KJE.FloatArray(aE)}if(this.CALC_INVESTMENT){var aH=this.DS_INVEST_BALANCE=KJE.FloatArray(aE)}m[M]="0";C[M]=F;if(this.CALC_ACCEL){s[M]=aG}ab[M++]=aG;for(Q=1;Q<=U;Q++){S=Q-1;if(Q%A==0){m[M]=""+(U<120?M*A:M);if(this.CALC_ACCEL){s[M]=ah[S]}if(this.CALC_INVESTMENT){aH[M]=k[S]}C[M]=aw[S];ab[M++]=p[S]}if(e){if(this.CALC_INVESTMENT){aI.addRepeat(Q,X.dollars(aA[S]+K[S],2),X.dollars(aA[S],2),X.dollars(ah[S],2),X.dollars(T[S],2),X.dollars(L[S],2),X.dollars(k[S],2))}else{if(this.CALC_ACCEL){aI.addRepeat(Q,X.dollars(B[S],2),X.dollars(aD[S],2),X.dollars(p[S],2),X.dollars(aA[S],2),X.dollars(K[S],2),X.dollars(ah[S],2))}else{if(this.AMOUNT_ONLY){aI.addRepeat(Q,X.dollars(g[S],2),X.dollars(ai[S],2),X.dollars(g[S]+ai[S],2),X.dollars(aw[S],2))}else{aI.addRepeat(Q,X.dollars(B[S],2),X.dollars(aD[S],2),X.dollars(B[S]+aD[S],2),X.dollars(p[S],2))}}}}}if(M<m.length){m[M]=""+(U<120?M*A:M)}var ac=Y-V;if(this.CALC_ACCEL){ac=Y-au}var ao="";if(this.AMOUNT_ONLY){ao=KJE.getKJEReplaced(this.MSG_TITLE_AMOUNT,X.dollars(F),X.dollars(Y))}else{if(this.CALC_INVESTMENT){ao=KJE.getKJEReplaced(this.MSG_TITLE_INVEST,X.dollars(aK),X.number(this.NEW_LOAN_TERM/12))}else{if(ac>0){ao=KJE.getKJEReplaced(this.MSG_TITLE1,X.dollars(ac,2))}else{ao=KJE.getKJEReplaced(this.MSG_TITLE2,X.dollars(-1*(ac),2))}}}this.MSG_TITLE=KJE.replace("NEW_LOAN_PAYMENT",KJE.dollars(al,2),ao);if(this.d30_LOAN_TERM>0&&this.d30_LOAN_RATE>0){this.d30_LOAN_PAYMENT=X.round(KJE.PMT(this.d30_LOAN_RATE/1200,this.d30_LOAN_TERM*12,aG),2);this.d30_INTEREST=this.d30_LOAN_PAYMENT*this.d30_LOAN_TERM*12-aG}else{this.d30_LOAN_PAYMENT=0;this.d30_INTEREST=0}this.INTEREST_CURRENT=Y;this.INTEREST_NEW=V;this.INTEREST_ACCEL=au;this.ENDING_INVESTMENT_BAL=aK;this.MONTHLY_PAYMENT=D;this.AVERAGE_RATE=l;this.OUTSTANDING_BALANCE=F;this.CC_MONTHLY_PAYMENT=r;this.CC_AVERAGE_RATE=aB;this.CC_OUTSTANDING_BALANCE=c;this.AUTO_MONTHLY_PAYMENT=I;this.AUTO_AVERAGE_RATE=b;this.AUTO_OUTSTANDING_BALANCE=ay;this.OTHER_MONTHLY_PAYMENT=W;this.OTHER_AVERAGE_RATE=o;this.OTHER_OUTSTANDING_BALANCE=at;this.OLD_OUTSTANDING_BALANCE=F;this.NEW_LOAN_PAYMENT=al;this.NEW_LOAN_BALANCE=aG};KJE.DebtCalculation.prototype.formatReport=function(a){var b=KJE;var c=a;if(this.bInterestOnly){c=KJE.replace("<!--INTEREST_ONLY","<!--",c);c=KJE.replace("INTEREST_ONLY-->","-->",c)}else{c=KJE.replace("<!--INTEREST_ONLY","",c);c=KJE.replace("INTEREST_ONLY-->","",c)}c=KJE.replace("CC_OUTSTANDING_BALANCE",b.dollars(this.CC_OUTSTANDING_BALANCE,2),c);c=KJE.replace("CC_MONTHLY_PAYMENT",b.dollars(this.CC_MONTHLY_PAYMENT,2),c);c=KJE.replace("CC_AVERAGE_RATE",b.percent(this.CC_AVERAGE_RATE,2),c);c=KJE.replace("AUTO_MONTHLY_PAYMENT",b.dollars(this.AUTO_MONTHLY_PAYMENT,2),c);c=KJE.replace("AUTO_AVERAGE_RATE",b.percent(this.AUTO_AVERAGE_RATE,2),c);c=KJE.replace("AUTO_OUTSTANDING_BALANCE",b.dollars(this.AUTO_OUTSTANDING_BALANCE,2),c);c=KJE.replace("OTHER_MONTHLY_PAYMENT",b.dollars(this.OTHER_MONTHLY_PAYMENT,2),c);c=KJE.replace("OTHER_AVERAGE_RATE",b.percent(this.OTHER_AVERAGE_RATE,2),c);c=KJE.replace("OTHER_OUTSTANDING_BALANCE",b.dollars(this.OTHER_OUTSTANDING_BALANCE,2),c);c=KJE.replace("LOAN_TERM_LABEL",this.LOAN_TERM_LABEL,c);if(this.MONTHLY_PAYMENT>this.NEW_LOAN_PAYMENT){c=KJE.replace("MONTHLY_PAYMENT_SAVINGS",(this.bFrance?this.MSG_LESS+" ":"")+b.dollars(this.MONTHLY_PAYMENT-this.NEW_LOAN_PAYMENT,2)+(this.bFrance?"":" "+this.MSG_LESS),c)}else{c=KJE.replace("MONTHLY_PAYMENT_SAVINGS",(this.bFrance?" "+this.MSG_MORE+" ":"")+b.dollars(this.NEW_LOAN_PAYMENT-this.MONTHLY_PAYMENT,2)+(this.bFrance?"":" "+this.MSG_MORE),c)}c=KJE.replace("MONTHLY_PAYMENT",b.dollars(this.MONTHLY_PAYMENT,2),c);c=KJE.replace("AVERAGE_RATE",b.percent(this.AVERAGE_RATE,2),c);c=KJE.replace("OUTSTANDING_BALANCE",b.dollars(this.OUTSTANDING_BALANCE,2),c);c=KJE.replace("NEW_LOAN_BALANCE",b.dollars(this.NEW_LOAN_BALANCE,2),c);c=KJE.replace("NEW_LOAN_RATE",b.percent(this.NEW_LOAN_RATE/100,2),c);c=KJE.replace("NEW_LOAN_PAYMENT",b.dollars(this.NEW_LOAN_PAYMENT,2),c);c=KJE.replace("NEW_LOAN_TERM",b.number(this.NEW_LOAN_TERM),c);c=KJE.replace("ACCELERATE_BALANCE",b.dollars(this.ACCELERATE_BALANCE,2),c);c=KJE.replace("ACC_LOAN_PAYMENT",b.dollars(this.ACC_LOAN_PAYMENT,2),c);c=KJE.replace("CURRENT_PAYOFF",this.CURRENT_PAYOFF,c);c=KJE.replace("ACCEL_PAYOFF",this.ACCEL_PAYOFF,c);c=KJE.replace("NEW_PAYOFF",this.NEW_PAYOFF,c);c=KJE.replace("INTEREST_CURRENT",b.dollars(this.INTEREST_CURRENT,2),c);c=KJE.replace("INTEREST_NEW",b.dollars(this.INTEREST_NEW,2),c);c=KJE.replace("INTEREST_ACCEL",b.dollars(this.INTEREST_ACCEL,2),c);c=KJE.replace("MSG_TITLE",(this.MSG_TITLE),c);c=KJE.replace("NEW_LOAN_YEARS",b.number(this.NEW_LOAN_TERM/12),c);if(this.d30_LOAN_TERM>0&&this.d30_LOAN_RATE>0){c=KJE.replace("30_LOAN_TERM",b.number(this.d30_LOAN_TERM),c);c=KJE.replace("30_LOAN_BALANCE",b.dollars(this.NEW_LOAN_BALANCE,2),c);c=KJE.replace("30_LOAN_RATE",b.percent(this.d30_LOAN_RATE/100,2),c);c=KJE.replace("30_LOAN_PAYMENT",b.dollars(this.d30_LOAN_PAYMENT,2),c);c=KJE.replace("30_INTEREST_SAVINGS",b.dollars(this.d30_INTEREST-this.INTEREST_NEW,2),c);c=KJE.replace("30_INTEREST",b.dollars(this.d30_INTEREST,2),c)}if(this.INTEREST_CURRENT>=this.INTEREST_ACCEL){c=KJE.replace("MSG_ACCEL_INTEREST_SAVINGS",(this.bFrance?this.MSG_LESS+" ":"")+b.dollars(this.INTEREST_NEW-this.INTEREST_ACCEL,2)+" "+(this.bFrance?"":" "+this.MSG_LESS),c)}else{c=KJE.replace("MSG_ACCEL_INTEREST_SAVINGS",(this.bFrance?this.MSG_MORE+" ":"")+b.dollars(this.INTEREST_ACCEL-this.INTEREST_NEW,2)+(this.bFrance?"":" "+this.MSG_MORE),c)}c=KJE.replace("ACCEL_INTEREST_SAVINGS",b.dollars(this.INTEREST_CURRENT-this.INTEREST_ACCEL,2),c);if(this.INTEREST_CURRENT>=this.INTEREST_NEW){c=KJE.replace("MSG_NEW_INTEREST_SAVINGS",(this.bFrance?this.MSG_LESS+" ":"")+b.dollars(this.INTEREST_CURRENT-this.INTEREST_NEW,2)+(this.bFrance?"":" "+this.MSG_LESS),c)}else{c=KJE.replace("MSG_NEW_INTEREST_SAVINGS",(this.bFrance?this.MSG_MORE+" ":"")+b.dollars(this.INTEREST_NEW-this.INTEREST_CURRENT,2)+(this.bFrance?"":" "+this.MSG_MORE),c)}c=KJE.replace("NEW_INTEREST_SAVINGS",b.dollars(this.INTEREST_CURRENT-this.INTEREST_NEW,2),c);if(this.INTEREST_CURRENT>=this.INTEREST_ACCEL){c=KJE.replace("MSG_INTEREST_SAVINGS",(this.bFrance?this.MSG_LESS+" ":"")+b.dollars(this.INTEREST_CURRENT-this.INTEREST_ACCEL,2)+(this.bFrance?"":" "+this.MSG_LESS),c)}else{c=KJE.replace("MSG_INTEREST_SAVINGS",(this.bFrance?this.MSG_MORE+" ":"")+b.dollars(this.INTEREST_ACCEL-this.INTEREST_CURRENT,2)+(this.bFrance?"":" "+this.MSG_MORE),c)}c=KJE.replace("INTEREST_SAVINGS",b.dollars(this.INTEREST_NEW-this.INTEREST_ACCEL,2),c);c=KJE.replace("INCOME_TAX_RATE",b.percent(this.INCOME_TAX_RATE/100,2),c);c=KJE.replace("FIRST_YEARS_INTEREST",b.dollars(this.FIRST_YEARS_INTEREST,2),c);c=KJE.replace("TAX_SAVINGS",b.dollars(this.TAX_SAVINGS,2),c);c=KJE.replace("ENDING_INVESTMENT_BAL",b.dollars(this.ENDING_INVESTMENT_BAL,2),c);c=KJE.replace("NET_CASH",b.dollars(this.NET_CASH,2),c);c=KJE.replace("AVAIL_MARGIN",b.dollars(this.AVAIL_MARGIN,2),c);c=KJE.replace("INVESTMENT_PERCENT",b.percent(this.INVESTMENT_PERCENT/100),c);c=KJE.replace("ACC_INVESTMENT_AMT",b.dollars(this.ACC_INVESTMENT_AMT,2),c);c=KJE.replace("RETURN_PERCENT",b.percent(this.RETURN_PERCENT/100,2),c);c=KJE.replace("**FOOTER1**",(this.FOOTER1?this.FOOTER1:""),c);c=c.replace("**REPEATING GROUP**",this.sSchedule.getRepeat());this.sSchedule.clearRepeat();return c};KJE.DebtCalculation.prototype.setLoanCount=function(c,a,b){this._iCCCount=c;this._iLNCount=a;this._iALCount=b;this.CC_BALANCE=KJE.FloatArray(c);this.CC_RATE=KJE.FloatArray(c);this.CC_PAYMENT=KJE.FloatArray(c);this.CC_OLD=KJE.FloatArray(c);this.CC_NAME=new Array(c);this.LOAN_CURRENT_BALANCE=KJE.FloatArray(a);this.LOAN_PAYMENT=KJE.FloatArray(a);this.LOAN_MONTHS_LEFT=KJE.FloatArray(a);this.LOAN_INTEREST_RATE=KJE.FloatArray(a);this.ccBal=KJE.FloatArray(c);this.loanBal=KJE.FloatArray(a);this.MSG_MONTHS=KJE.parameters.get("MSG_MONTHS","mo.");this.MSG_MONTHS_TWO=KJE.parameters.get("MSG_MONTHS_TWO","(MSG_YEAR)");this.bFrance=KJE.parameters.get("MSG_CHANGE_PREFIX",false);for(var d=0;d<c;d++){this.CC_NAME[d]=KJE.parameters.get("CC_NAME_"+(d+1),KJE.parameters.get("MSG_CREDIT_CARD","Credit card")+" "+(d+1))}this.CC_USE_MINIMUM=KJE.parameters.get("CC_MINIMUMS",true)};KJE.DebtCalculation.prototype.CCPayment=function(c,d,e,b){var a=KJE.round(0.04*d,2);if(c){a=(a<b?b:a)}else{a=e}return(d<=0?0:a)};KJE.DebtCalculation.prototype.getProductTerm=function(c){var e=0;var b=KJE.DebtCalculation.sProductList.length;var a=KJE.DebtCalculation.sProductList;for(var f=0;f<b;f++){if(c==(a[f])){e=KJE.DebtCalculation.dProductTerm.dProductTerm[f];break}}return e};KJE.DebtCalculation.INPUT_YEARS=false;KJE.DebtCalculation.dTerm=[12,24,36,48,60,72,84,96,108,120,144,180,240,300,360];KJE.DebtCalculation.sTerm=new Array();KJE.DebtCalculation.MAXIMUM_TERM=360;KJE.DebtCalculation.MAXIMUM_TERM2=30;KJE.DebtCalculation.aTerm=["12"," 72","120","360"];KJE.DebtCalculation.aTerm2=["1","6","15","30"];KJE.DebtCalculation.sProductList=KJE.parameters.get("ARRAY_PRODUCT_LIST",["Interest-Only Line","5 Year Loan","10 Year Loan","15 Year Loan"]);KJE.DebtCalculation.dProductTerm=KJE.parameters.get("ARRAY_PRODUCT_TERM",[120,60,120,180]);KJE.DebtCalculation.dProductIO=KJE.parameters.get("ARRAY_PRODUCT_IO",[true,false,false,false]);KJE.DebtCalculation.dProductMortgage=KJE.parameters.get("ARRAY_PRODUCT_MORTGAGE",[false,false,false,false]);KJE.DebtCalculation.iProductIndex=KJE.parameters.get("ARRAY_PRODUCT_INDEX",[0,1,2,3]);KJE.DebtCalculation.sOtherLabel=KJE.parameters.get("ARRAY_OTHER_LABELS",["Auto Loan 1","Auto Loan 2","Auto Loan 3","Personal Loan","Real-Estate Loan","Other Loan 1","Other Loan 2","Other Loan 3","Other Loan 4"]);KJE.DebtCalculation.getTerms=function(){var g=KJE;var h=KJE.DebtCalculation.INPUT_YEARS=KJE.parameters.get("INPUT_YEARS",KJE.DebtCalculation.INPUT_YEARS);var j=KJE.DebtCalculation.sTerm;var l=KJE.DebtCalculation.dTerm;var f=KJE.DebtCalculation.aTerm;var k=KJE.DebtCalculation.MAXIMUM_TERM=KJE.parameters.get("MAXIMUM_TERM",this.MAXIMUM_TERM);var b=KJE.DebtCalculation.MAXIMUM_TERM2=Math.round(KJE.DebtCalculation.MAXIMUM_TERM/12);if(h){f=KJE.DebtCalculation.aTerm2;b=KJE.DebtCalculation.MAXIMUM_TERM2=KJE.parameters.get("MAXIMUM_TERM2",KJE.DebtCalculation.MAXIMUM_TERM2);k=KJE.DebtCalculation.MAXIMUM_TERM=b*12}var a=KJE.parameters.get("USE_CUSTOM_TERMS",false);f[f.length-1]=g.number(h?b:k,0);l[l.length-1]=k;if(!a){var c=KJE.parameters.get("MSG_MONTHS_TWO","(MSG_YEAR)");var e=KJE.parameters.get("MSG_YEAR","yr");var i=KJE.parameters.get("MSG_MONTHS","");for(var d=0;d<l.length;d++){if(l[d]<120||h){j[d]=g.number(l[d]/(h?12:1),0)+" "+(h?e:i)}else{j[d]=g.number(l[d],0)+" "+KJE.replace("MSG_YEAR",g.number(l[d]/12)+" "+e,c)}}}KJE.DebtCalculation.sTerm=j;KJE.DebtCalculation.dTerm=l;KJE.DebtCalculation.aTerm=f};KJE.DebtCalculation.getTermsDesc=function(){return KJE.DebtCalculation.sTerm};KJE.CalcName="How much do you owe?";KJE.CalcType="debtamount";KJE.CalculatorTitleTemplate="KJE1";KJE.parseInputs=function(a){KJE.DebtCalculation.getTerms();a=KJE.replace("**NEW_LOAN_TERM**",KJE.getDropBox("NEW_LOAN_TERM",KJE.parameters.get("NEW_LOAN_TERM",72),KJE.DebtCalculation.dTerm,KJE.DebtCalculation.sTerm),a);a=KJE.replace("**LOAN_TYPE_INDEX**",KJE.getDropBox("LOAN_TYPE_INDEX",KJE.parameters.get("LOAN_TYPE_INDEX",0),KJE.DebtCalculation.iProductIndex,KJE.DebtCalculation.sProductList),a);a=KJE.replace("**MSG_DEBT_HEADER**",KJE.parameters.get("MSG_TITLE5","1.  Enter your current debt balances"),a);a=KJE.replace("**MSG_NEW_LOAN_HEADER**",KJE.parameters.get("MSG_TITLE6","2.  Calculate your new consolidated loan"),a);a=KJE.replace("**MSG_ACCELERATE_HEADER**",KJE.parameters.get("MSG_TITLE7","3.  Apply monthly payment savings"),a);return a};KJE.initialize=function(){KJE.CalcControl=new KJE.DebtCalculation();KJE.GuiControl=new KJE.DebtConsolidate(KJE.CalcControl)};KJE.DebtConsolidate=function(i){var f=KJE;var x=KJE.gLegend;var o=KJE.inputs.items;this.NEW_LOAN_TERM_DROPDOWN=KJE.parameters.get("NEW_LOAN_TERM_DROPDOWN",true);this.CC_COUNT=KJE.parameters.get("CC_COUNT",10);this.LN_COUNT=KJE.parameters.get("LN_COUNT",9);this.AL_COUNT=KJE.parameters.get("AL_COUNT",3);i.setLoanCount(this.CC_COUNT,this.LN_COUNT,this.AL_COUNT);KJE.Checkbox("CC_USE_MINIMUM","Minimum Payments",true,"Use credit card minimum for payments");this.CC_PAYMENT=new Array(this.CC_COUNT);this.CC_BALANCE=new Array(this.CC_COUNT);this.CC_RATE=new Array(this.CC_COUNT);this.LOAN_CURRENT_BALANCE=new Array(this.LN_COUNT);this.LOAN_PAYMENT=new Array(this.LN_COUNT);this.LOAN_INTEREST_RATE=new Array(this.LN_COUNT);this.LOAN_MONTHS_LEFT=new Array(this.LN_COUNT);for(var m=0;m<this.CC_COUNT;m++){KJE.InputItem.AltHelpName="CC_BALANCE";this.CC_BALANCE[m]=KJE.DollarSlider("CC_BALANCE"+(m+1),KJE.parameters.get("MSG_CC_BALANCE"+(m+1),KJE.replace("MSG_CC_NUMBER",(m+1)+"",KJE.parameters.get("MSG_CC_BALANCE","Credit Card Balance #MSG_CC_NUMBER"))),0,100000,0,0,1,KJE.parameters.get("KJEBoldStyle","bold"));KJE.InputItem.AltHelpName="CC_RATE";this.CC_RATE[m]=KJE.PercentSlider("CC_RATE"+(m+1),KJE.parameters.get("MSG_CC_RATE","Interest rate"),0,30,2);KJE.InputItem.AltHelpName="CC_PAYMENT";this.CC_PAYMENT[m]=KJE.DollarSlider("CC_PAYMENT"+(m+1),KJE.parameters.get("MSG_CC_PAYMENT","Payment"),0,100000,0,0,0);if(i.CC_USE_MINIMUM){this.CC_PAYMENT[m].disable()}i.CC_OLD[m]=this.CC_BALANCE[m].getValue()+this.CC_RATE[m].getValue()}for(var m=0;m<this.LN_COUNT;m++){KJE.InputItem.AltHelpName="LOAN_CURRENT_BALANCE";this.LOAN_CURRENT_BALANCE[m]=KJE.DollarSlider("LOAN_CURRENT_BALANCE"+(m+1),KJE.parameters.get("MSG_LOAN_CURRENT_BALANCE"+(m+1),KJE.DebtCalculation.sOtherLabel[m]),0,10000000,0,0,2,KJE.parameters.get("KJEBoldStyle","bold"));KJE.InputItem.AltHelpName="LOAN_INTEREST_RATE";this.LOAN_INTEREST_RATE[m]=KJE.PercentSlider("LOAN_INTEREST_RATE"+(m+1),KJE.parameters.get("MSG_LOAN_INTEREST_RATE","Interest rate"),0,30,2);KJE.InputItem.AltHelpName="LOAN_PAYMENT";this.LOAN_PAYMENT[m]=KJE.DollarSlider("LOAN_PAYMENT"+(m+1),KJE.parameters.get("MSG_LOAN_PAYMENT","Payment"),0,100000,0,0,0);KJE.InputItem.AltHelpName="LOAN_MONTHS_LEFT";this.LOAN_MONTHS_LEFT[m]=KJE.Label("LOAN_MONTHS_LEFT"+(m+1),KJE.parameters.get("MSG_LOAN_MONTHS_LEFT","Payments remaining"))}KJE.InputItem.AltHelpName=null;if(!i.AMOUNT_ONLY){KJE.DollarSlider("NEW_LOAN_BALANCE","Loan balance",0,1000000);KJE.Label("NEW_LOAN_BALANCE_SHOW","Loan balance");KJE.PercentSlider("NEW_LOAN_RATE","Interest rate",0,25,1);KJE.DollarSlider("NEW_LOAN_PAYMENT","Payment",0,100000,2);KJE.DollarSlider("ACCELERATE_BALANCE","Amount",0,100000,2,0,7);if(this.NEW_LOAN_TERM_DROPDOWN){KJE.DropBoxSlider("NEW_LOAN_TERM","Term",KJE.DebtCalculation.dTerm)}else{if(i.MORTGAGE_CONSOLIDATE&&i.USE_LOAN_TYPE){KJE.DropBox("LOAN_TYPE_INDEX","Repayment term")}else{KJE.DropBox("LOAN_TYPE_INDEX","Loan type");KJE.NumberSlider("NEW_LOAN_TERM","Term in months",1,KJE.Default.MortgageTermMax*12)}}}if(i.SHOW_TAXES){KJE.PercentSlider("INCOME_TAX_RATE","Tax rate",0,50,1,1)}if(i.CALC_INVESTMENT){KJE.Label("NET_CASH","Net cash");KJE.RateSlider("RETURN_PERCENT","Rate of return");KJE.PercentSlider("INVESTMENT_PERCENT","Percent to invest",0,100,0,1);KJE.DollarSlider("NEW_LOAN_FEES","Fees",0,10000,0);this.MSG_GRAPH_COL1=KJE.parameters.get("MSG_GRAPH_COL1","Investment balance");this.MSG_GRAPH_COL2=KJE.parameters.get("MSG_GRAPH_COL2","Loan balance")}this.MSG_GRAPH3=KJE.parameters.get("MSG_GRAPH3","Loan Balances");this.FOOTER1=null;if(i.MORTGAGE_CONSOLIDATE){var v=KJE.gNewGraph(KJE.gCATEGORIES,"GRAPH1",true,false,KJE.colorList[1],KJE.parameters.get("MSG_GRAPH1","Monthly Payment Comparison"));v._showItemLabel=true;v._showItemLabelOnTop=true;v._legend._iOrientation=x.TOP_RIGHT;this.FOOTER1=KJE.addDiv("FOOTER1",KJE.colorList[1])}else{if(i.AMOUNT_ONLY){var v=KJE.gNewGraph(KJE.gLINE,"GRAPH1",true,false,KJE.colorList[1],KJE.parameters.get("MSG_GRAPH1","Time to pay off debt is KJE1."));v._iArea=KJE.gGraphLine.AREA_FIRST_ONLY;v._legend.setVisible(false)}else{if(i.CALC_INVESTMENT){var v=KJE.gNewGraph(KJE.gLINE,"GRAPH1",true,false,KJE.colorList[1],KJE.parameters.get("MSG_GRAPH1","Consolidated Loan and Investment Balances"));v._iArea=KJE.gGraphLine.AREA_FIRST_ONLY;v._legend._iOrientation=x.TOP_RIGHT}else{this.SHOW_INTEREST_GRAPH=KJE.parameters.get("SHOW_INTEREST_GRAPH",false);var v=KJE.gNewGraph(KJE.gCATEGORIES,"GRAPH1",true,false,KJE.colorList[1],KJE.parameters.get("MSG_GRAPH1",this.SHOW_INTEREST_GRAPH?"Total Interest Paid":"Time to Pay Off Debt"));v._showItemLabel=true;v._showItemLabelFmt=f.FMT_NUMBER;v._showItemLabelOnTop=true;v._axisY.setFormat(f.FMT_NUMBER);v._legend._iOrientation=x.TOP_RIGHT;var w=KJE.gNewGraph(KJE.gCATEGORIES,"GRAPH2",true,true,KJE.colorList[1],KJE.parameters.get("MSG_GRAPH2","Monthly Payment Comparison"));w._showItemLabel=true;w._showItemLabelOnTop=true;w._legend._iOrientation=x.TOP_RIGHT}}}if(this.CC_COUNT>0){var a=KJE.parameters.get("MSG_CC_TITLE","Credit card debt:");var c=KJE.parameters.get("MSG_CC_CLOSETITLE","KJE1");var e=function(){return a+"|"+KJE.subText(KJE.getKJEReplaced(c,f.dollars(i.CC_OUTSTANDING_BALANCE)),"KJERightBold")};KJE.addDropper(new KJE.Dropper("CC",false,e,e),KJE.colorList[0])}if(this.AL_COUNT>0){var b=KJE.parameters.get("MSG_AUTO_TITLE","Auto loan debt:");var p=KJE.parameters.get("MSG_AUTO_CLOSETITLE","KJE1");var j=function(){return b+"|"+KJE.subText(KJE.getKJEReplaced(p,f.dollars(i.AUTO_OUTSTANDING_BALANCE)),"KJERightBold")};KJE.addDropper(new KJE.Dropper("AUTO",false,j,j),KJE.colorList[0])}var s=KJE.parameters.get("MSG_OTHER_TITLE","Other loans & installment debt:");var g=KJE.parameters.get("MSG_OTHER_CLOSETITLE","KJE1");var h=function(){return s+"|"+KJE.subText(KJE.getKJEReplaced(g,f.dollars(i.OTHER_OUTSTANDING_BALANCE)),"KJERightBold")};KJE.addDropper(new KJE.Dropper("OTHER",false,h,h),KJE.colorList[0]);if(!i.AMOUNT_ONLY){var t=KJE.parameters.get("MSG_NEW_LOAN_TITLE","New consolidated loan:");var q=KJE.parameters.get("MSG_NEW_LOAN_CLOSETITLE","KJE1");var k=function(){return t+"|"+KJE.subText(KJE.getKJEReplaced(q,f.dollars(i.NEW_LOAN_BALANCE)),"KJERightBold")};KJE.addDropper(new KJE.Dropper("NEW_LOAN",true,k,k),KJE.colorList[0]);if(i.CALC_ACCEL){var r=KJE.parameters.get("MSG_ACCELERATE_TITLE","Apply monthly payment savings:");var u=KJE.parameters.get("MSG_ACCELERATE_CLOSETITLE","KJE1");var d=function(){return r+"|"+KJE.subText(KJE.getKJEReplaced(u,o.ACCELERATE_BALANCE.getFormatted()),"KJERightBold")};KJE.addDropper(new KJE.Dropper("ACCELERATE",true,r,d),KJE.colorList[0])}}};KJE.DebtConsolidate.prototype.setValues=function(c){var a=KJE.inputs.items;var b=a.CC_USE_MINIMUM.getValue();if(c.CC_USE_MINIMUM!=b){if(b){for(var d=0;d<this.CC_COUNT;d++){this.CC_PAYMENT[d].disable()}c.CALC_CC_PAYMENT=true}else{for(var d=0;d<this.CC_COUNT;d++){this.CC_PAYMENT[d].enable()}c.CALC_CC_PAYMENT=false}c.CC_USE_MINIMUM=a.CC_USE_MINIMUM.getValue()}if(!c.AMOUNT_ONLY){c.NEW_LOAN_BALANCE=a.NEW_LOAN_BALANCE.getValue();c.NEW_LOAN_RATE=a.NEW_LOAN_RATE.getValue();c.NEW_LOAN_PAYMENT=a.NEW_LOAN_PAYMENT.getValue();if(a.LOAN_TYPE_INDEX){c.LOAN_TYPE_INDEX=a.LOAN_TYPE_INDEX.getValue()}if(c.MORTGAGE_CONSOLIDATE&&c.USE_LOAN_TYPE){c.FOOTER1=(KJE.parameters.get(KJE.DebtCalculation.dProductIO[c.LOAN_TYPE_INDEX]?"MSG_INTEREST_ONLY_TRUE":"MSG_INTEREST_ONLY_FALSE",""))}else{c.NEW_LOAN_TERM=a.NEW_LOAN_TERM.getValue()}c.ACCELERATE_BALANCE=a.ACCELERATE_BALANCE.getValue()}else{c.NEW_LOAN_TERM=360;c.OLD_OUTSTANDING_BALANCE=-1;c.NEW_LOAN_BALANCE=5000}for(var d=0;d<this.CC_COUNT;d++){c.CC_BALANCE[d]=this.CC_BALANCE[d].getValue();c.CC_RATE[d]=this.CC_RATE[d].getValue();c.CC_PAYMENT[d]=this.CC_PAYMENT[d].getValue()}for(var d=0;d<this.LN_COUNT;d++){if(d<this.LN_COUNT){c.LOAN_PAYMENT[d]=this.LOAN_PAYMENT[d].getValue();c.LOAN_CURRENT_BALANCE[d]=this.LOAN_CURRENT_BALANCE[d].getValue();c.LOAN_INTEREST_RATE[d]=this.LOAN_INTEREST_RATE[d].getValue()}}c.CALC_CC_PAYMENT=true;if(c.SHOW_TAXES){c.INCOME_TAX_RATE=a.INCOME_TAX_RATE.getValue()}if(c.CALC_INVESTMENT){c.NEW_LOAN_FEES=a.NEW_LOAN_FEES.getValue();c.INVESTMENT_PERCENT=a.INVESTMENT_PERCENT.getValue();c.RETURN_PERCENT=a.RETURN_PERCENT.getValue()}};KJE.DebtConsolidate.prototype.refresh=function(f){var e=KJE;var d=KJE.gLegend;var b=KJE.inputs.items;var a=KJE.gGraphs[0];KJE.setTitleTemplate(f.MSG_TITLE);if(f.MORTGAGE_CONSOLIDATE){var a=KJE.gGraphs[0];a.removeAll();a.setGraphCategories(f.DS_PAYMENT_CATS);a._sGraphCategoriesBold=f.DS_PAYMENTS_BLD;a.add(new KJE.gGraphDataSeries(f.DS_PAYMENTS,this.MSG_GRAPH3,a.getColor(1)));a.paint()}else{if(f.AMOUNT_ONLY){a.removeAll();a.add(new KJE.gGraphDataSeries(f.DS_BALANCE,f.CURRENT_PAYOFF,a.getColor(1)));a.setGraphCategories(f.cats);if(f.CURRENT_PAYOFF_MONTHS<=120){a._titleXAxis.setText(KJE.MSG_MONTH_LBL)}else{a._titleXAxis.setText(KJE.MSG_YEAR_LBL)}a.setTitleTemplate(f.CURRENT_PAYOFF);a.paint()}else{if(f.CALC_INVESTMENT){a.removeAll();a.setGraphCategories(f.cats);if(f.NEW_LOAN_TERM<120){a._titleXAxis.setText(KJE.MSG_MONTH_LBL)}else{a._titleXAxis.setText(KJE.MSG_YEAR_LBL)}a.add(new KJE.gGraphDataSeries(f.DS_INVEST_BALANCE,this.MSG_GRAPH_COL1,a.getColor(1)));a.add(new KJE.gGraphDataSeries(f.DS_ACCEL_BALANCE,this.MSG_GRAPH_COL2,a.getColor(2)));a.paint()}else{a.removeAll();a.setGraphCategories(f.DS_PAYMENT_CATS);if(this.SHOW_INTEREST_GRAPH){a._sGraphCategoriesBold=f.DS_INTEREST_BLD;a.add(new KJE.gGraphDataSeries(f.DS_INTEREST,f.DS_PAYMENT_CATS[0],a.getColor(1)))}else{a._sGraphCategoriesBold=f.DS_MONTHS_BLD;a.add(new KJE.gGraphDataSeries(f.DS_MONTHS,f.DS_PAYMENT_CATS[0],a.getColor(1)))}a.paint();var c=KJE.gGraphs[1];c.removeAll();c.setGraphCategories(f.DS_PAYMENT_CATS);c._sGraphCategoriesBold=f.DS_PAYMENTS_BLD;c.add(new KJE.gGraphDataSeries(f.DS_PAYMENTS,this.MSG_GRAPH3,c.getColor(1)));c.paint()}}}if(f.CC_USE_MINIMUM){for(var g=0;g<this.CC_COUNT;g++){this.CC_PAYMENT[g].setValue(f.CC_PAYMENT[g],true)}}for(var g=0;g<this.LN_COUNT;g++){this.LOAN_MONTHS_LEFT[g].setText(f.LOAN_MONTHS_LEFT[g]?e.number(f.LOAN_MONTHS_LEFT[g]):"",true)}if(!f.AMOUNT_ONLY){if(f.CALC_ACCEL){b.ACCELERATE_BALANCE.setValue(f.ACCELERATE_BALANCE,true)}if(f.CALC_INVESTMENT){b.NET_CASH.setText(e.dollars(f.NET_CASH))}b.NEW_LOAN_BALANCE.setValue(f.NEW_LOAN_BALANCE,true);b.NEW_LOAN_RATE.setValue(f.NEW_LOAN_RATE,true);b.NEW_LOAN_PAYMENT.setValue(f.NEW_LOAN_PAYMENT,true);if(!this.NEW_LOAN_TERM_DROPDOWN){if(b.NEW_LOAN_TERM){b.NEW_LOAN_TERM.setValue(f.NEW_LOAN_TERM,true)}}if(b.NEW_LOAN_BALANCE_SHOW){b.NEW_LOAN_BALANCE_SHOW.setText(e.dollars(f.NEW_LOAN_BALANCE))}}if(this.FOOTER1!=null){this.FOOTER1.innerHTML=f.FOOTER1}};KJE.InputScreenText=" <div id=KJE-D-CC><div id=KJE-P-CC>Input information:</div></div> <div id=KJE-E-CC > <div id='KJE-C-CC_USE_MINIMUM'><input id='KJE-CC_USE_MINIMUM' type=checkbox name='CC_USE_MINIMUM' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE1'><input id='KJE-CC_BALANCE1' /></div> <div id='KJE-C-CC_RATE1'><input id='KJE-CC_RATE1' /></div> <div id='KJE-C-CC_PAYMENT1'><input id='KJE-CC_PAYMENT1' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE2'><input id='KJE-CC_BALANCE2' /></div> <div id='KJE-C-CC_RATE2'><input id='KJE-CC_RATE2' /></div> <div id='KJE-C-CC_PAYMENT2'><input id='KJE-CC_PAYMENT2' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE3'><input id='KJE-CC_BALANCE3' /></div> <div id='KJE-C-CC_RATE3'><input id='KJE-CC_RATE3' /></div> <div id='KJE-C-CC_PAYMENT3'><input id='KJE-CC_PAYMENT3' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE4'><input id='KJE-CC_BALANCE4' /></div> <div id='KJE-C-CC_RATE4'><input id='KJE-CC_RATE4' /></div> <div id='KJE-C-CC_PAYMENT4'><input id='KJE-CC_PAYMENT4' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE5'><input id='KJE-CC_BALANCE5' /></div> <div id='KJE-C-CC_RATE5'><input id='KJE-CC_RATE5' /></div> <div id='KJE-C-CC_PAYMENT5'><input id='KJE-CC_PAYMENT5' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE6'><input id='KJE-CC_BALANCE6' /></div> <div id='KJE-C-CC_RATE6'><input id='KJE-CC_RATE6' /></div> <div id='KJE-C-CC_PAYMENT6'><input id='KJE-CC_PAYMENT6' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE7'><input id='KJE-CC_BALANCE7' /></div> <div id='KJE-C-CC_RATE7'><input id='KJE-CC_RATE7' /></div> <div id='KJE-C-CC_PAYMENT7'><input id='KJE-CC_PAYMENT7' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE8'><input id='KJE-CC_BALANCE8' /></div> <div id='KJE-C-CC_RATE8'><input id='KJE-CC_RATE8' /></div> <div id='KJE-C-CC_PAYMENT8'><input id='KJE-CC_PAYMENT8' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE9'><input id='KJE-CC_BALANCE9' /></div> <div id='KJE-C-CC_RATE9'><input id='KJE-CC_RATE9' /></div> <div id='KJE-C-CC_PAYMENT9'><input id='KJE-CC_PAYMENT9' /></div> <hr class=KJEDivide /> <div id='KJE-C-CC_BALANCE10'><input id='KJE-CC_BALANCE10' /></div> <div id='KJE-C-CC_RATE10'><input id='KJE-CC_RATE10' /></div> <div id='KJE-C-CC_PAYMENT10'><input id='KJE-CC_PAYMENT10' /></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-AUTO><div id=KJE-P-AUTO>Input information:</div></div> <div id=KJE-E-AUTO > <div id='KJE-C-LOAN_CURRENT_BALANCE1'><input id='KJE-LOAN_CURRENT_BALANCE1' /></div> <div id='KJE-C-LOAN_INTEREST_RATE1'><input id='KJE-LOAN_INTEREST_RATE1' /></div> <div id='KJE-C-LOAN_PAYMENT1'><input id='KJE-LOAN_PAYMENT1' /></div> <div id='KJE-C-LOAN_MONTHS_LEFT1'><div id='KJE-LOAN_MONTHS_LEFT1' ></div></div> <hr class=KJEDivide /> <div id='KJE-C-LOAN_CURRENT_BALANCE2'><input id='KJE-LOAN_CURRENT_BALANCE2' /></div> <div id='KJE-C-LOAN_INTEREST_RATE2'><input id='KJE-LOAN_INTEREST_RATE2' /></div> <div id='KJE-C-LOAN_PAYMENT2'><input id='KJE-LOAN_PAYMENT2' ></div> <div id='KJE-C-LOAN_MONTHS_LEFT2'><div id='KJE-LOAN_MONTHS_LEFT2' ></div></div> <hr class=KJEDivide /> <div id='KJE-C-LOAN_CURRENT_BALANCE3'><input id='KJE-LOAN_CURRENT_BALANCE3' /></div> <div id='KJE-C-LOAN_INTEREST_RATE3'><input id='KJE-LOAN_INTEREST_RATE3' /></div> <div id='KJE-C-LOAN_PAYMENT3'><input id='KJE-LOAN_PAYMENT3' /></div> <div id='KJE-C-LOAN_MONTHS_LEFT3'><div id='KJE-LOAN_MONTHS_LEFT3' ></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-OTHER><div id=KJE-P-OTHER>Input information:</div></div> <div id=KJE-E-OTHER > <div id='KJE-C-LOAN_CURRENT_BALANCE4'><input id='KJE-LOAN_CURRENT_BALANCE4' /></div> <div id='KJE-C-LOAN_INTEREST_RATE4'><input id='KJE-LOAN_INTEREST_RATE4' /></div> <div id='KJE-C-LOAN_PAYMENT4'><input id='KJE-LOAN_PAYMENT4' /></div> <div id='KJE-C-LOAN_MONTHS_LEFT4'><div id='KJE-LOAN_MONTHS_LEFT4' ></div></div> <hr class=KJEDivide /> <div id='KJE-C-LOAN_CURRENT_BALANCE5'><input id='KJE-LOAN_CURRENT_BALANCE5' /></div> <div id='KJE-C-LOAN_INTEREST_RATE5'><input id='KJE-LOAN_INTEREST_RATE5' /></div> <div id='KJE-C-LOAN_PAYMENT5'><input id='KJE-LOAN_PAYMENT5' /></div> <div id='KJE-C-LOAN_MONTHS_LEFT5'><div id='KJE-LOAN_MONTHS_LEFT5' ></div></div> <hr class=KJEDivide /> <div id='KJE-C-LOAN_CURRENT_BALANCE6'><input id='KJE-LOAN_CURRENT_BALANCE6' /></div> <div id='KJE-C-LOAN_INTEREST_RATE6'><input id='KJE-LOAN_INTEREST_RATE6' /></div> <div id='KJE-C-LOAN_PAYMENT6'><input id='KJE-LOAN_PAYMENT6' /></div> <div id='KJE-C-LOAN_MONTHS_LEFT6'><div id='KJE-LOAN_MONTHS_LEFT6' ></div></div> <hr class=KJEDivide /> <div id='KJE-C-LOAN_CURRENT_BALANCE7'><input id='KJE-LOAN_CURRENT_BALANCE7' /></div> <div id='KJE-C-LOAN_INTEREST_RATE7'><input id='KJE-LOAN_INTEREST_RATE7' /></div> <div id='KJE-C-LOAN_PAYMENT7'><input id='KJE-LOAN_PAYMENT7' /></div> <div id='KJE-C-LOAN_MONTHS_LEFT7'><div id='KJE-LOAN_MONTHS_LEFT7' ></div></div> <hr class=KJEDivide /> <div id='KJE-C-LOAN_CURRENT_BALANCE8'><input id='KJE-LOAN_CURRENT_BALANCE8' /></div> <div id='KJE-C-LOAN_INTEREST_RATE8'><input id='KJE-LOAN_INTEREST_RATE8' /></div> <div id='KJE-C-LOAN_PAYMENT8'><input id='KJE-LOAN_PAYMENT8' /></div> <div id='KJE-C-LOAN_MONTHS_LEFT8'><div id='KJE-LOAN_MONTHS_LEFT8' ></div></div> <hr class=KJEDivide /> <div id='KJE-C-LOAN_CURRENT_BALANCE9'><input id='KJE-LOAN_CURRENT_BALANCE9' /></div> <div id='KJE-C-LOAN_INTEREST_RATE9'><input id='KJE-LOAN_INTEREST_RATE9' /></div> <div id='KJE-C-LOAN_PAYMENT9'><input id='KJE-LOAN_PAYMENT9' /></div> <div id='KJE-C-LOAN_MONTHS_LEFT9'><div id='KJE-LOAN_MONTHS_LEFT9' ></div></div> <div style=\"height:10px\"></div> </div> **GRAPH1** ";KJE.DefinitionText=" <div id='KJE-D-CC_USE_MINIMUM' ><dt>Use minimum payment</dt><dd>If you checked the &quot;use credit card minimum payments&quot; box, your monthly payment is calculated as 4% of your current outstanding balance. With the &quot;use credit card minimum payments&quot; box checked, your monthly payment will decrease as your balance is paid down. This can greatly increase the length of time it takes to pay off your credit cards. Uncheck this box to enter your own monthly payment that will remain the same until your balance is paid in full. <p>(We calculate your minimum monthly payment as 4% of your current outstanding balance. While your actual minimum monthly payment may be slightly different, this is one of the most common methods used by credit card companies to calculate minimum payments.)</dd></div> <div id='KJE-D-CC_BALANCE' ><dt>Credit card balance</dt><dd>Your total current balance for this credit card.</dd></div> <div id='KJE-D-CC_RATE' ><dt>Credit card interest rate</dt><dd>The annual percentage rate you pay for this credit card. The rate you enter is used to calculate the interest on all future credit card payments. The length of time to pay off this credit card may be much greater than calculated if you enter a low promotional interest rate that is only good for a short period of time.</dd></div> <div id='KJE-D-CC_PAYMENT' ><dt>Credit card payment</dt><dd>This is your initial monthly payment. If you checked the &quot;use credit card minimum payments&quot; box, your monthly payment is calculated as 4% of your current outstanding balance. With the &quot;use credit card minimum payments&quot; box checked, your monthly payment will decrease as your balance is paid down. This can greatly increase the length of time it takes to pay off your credit cards. Uncheck this box to enter your own monthly payment that will remain the same until your balance is paid in full. <p>(We calculate your minimum monthly payment as 4% of your current outstanding balance. While your actual minimum monthly payment may be slightly different, this is one of the most common methods used by credit card companies to calculate minimum payments.)</dd></div> <div id='KJE-D-LOAN_CURRENT_BALANCE' ><dt>Loan balance</dt><dd>Your total current balance for an installment loan.</dd></div> <div id='KJE-D-LOAN_INTEREST_RATE' ><dt>Loan interest rates</dt><dd>The annual percentage rate you pay for this loan. Enter the current interest rate for this loan. This calculator assumes your rate will remain the same for the entire repayment period. We use this to calculator the interest you will pay on this loan and the number of payments that are remaining.</dd></div> <div id='KJE-D-LOAN_PAYMENT' ><dt>Loan payment</dt><dd>This is your monthly payment. Enter the actual monthly payment for your loan. We use this to determine your payment totals and to calculate the remaining payments.</dd></div> <div id='KJE-D-LOAN_MONTHS_LEFT' ><dt>Remaining loan payments</dt><dd>This is the calculated number of payments remaining for this loan. It is based on your current balance, payment and interest rate.</dd></div> ";KJE.ReportText=' <!--HEADING "Debt Amount" HEADING--> <h2 class=\'KJEReportHeader KJEFontHeading\'>You owe a total of OUTSTANDING_BALANCE.</h2> The total of all current loans and credit card payments are MONTHLY_PAYMENT. If you continue to make the minimum payments it will take you CURRENT_PAYOFF to payoff this debt. The total interest paid will be INTEREST_CURRENT. **GRAPH** <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Result Summary</caption> <tr class=KJEOddRow><td class="KJELabel KJECellBorder KJECell60">Total outstanding debt</td><td class="KJECell KJECell40">OUTSTANDING_BALANCE </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Monthly payment </td><td class="KJECell ">MONTHLY_PAYMENT </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Average interest rate </td><td class="KJECell ">AVERAGE_RATE </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Total interest </td><td class="KJECell ">INTEREST_CURRENT</td></tr> <tr class=KJEFooterRow><td class="KJELabel KJECellBorder">Time to pay off debt </td><td class="KJELabel ">CURRENT_PAYOFF </td></tr></table> </div> <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Current Loans and Credit Cards</caption> <tr class=KJEFooterRow><td class="KJELabel KJECellBorder KJECell40">&nbsp; </td><td class="KJECellStrong KJECellBorder KJECell20">Amount Owed</td><td class="KJECellStrong KJECellBorder KJECell20">Monthly Payment</td><td class="KJECellStrong KJECell20">Interest Rate</td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Credit cards</td><td class="KJECell KJECellBorder">CC_OUTSTANDING_BALANCE</td><td class="KJECell KJECellBorder">CC_MONTHLY_PAYMENT</td><td class="KJECell">CC_AVERAGE_RATE</td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Auto loans</td><td class="KJECell KJECellBorder">AUTO_OUTSTANDING_BALANCE</td><td class="KJECell KJECellBorder">AUTO_MONTHLY_PAYMENT</td><td class="KJECell">AUTO_AVERAGE_RATE</td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Other loans</td><td class="KJECell KJECellBorder">OTHER_OUTSTANDING_BALANCE</td><td class="KJECell KJECellBorder">OTHER_MONTHLY_PAYMENT</td><td class="KJECell">OTHER_AVERAGE_RATE</td></tr> <tr class=KJEFooterRow><td class="KJELabel KJECellBorder">Totals</td><td class="KJELabel KJECellBorder">OUTSTANDING_BALANCE</td><td class="KJELabel KJECellBorder">MONTHLY_PAYMENT</td><td class="KJELabel">AVERAGE_RATE</td></tr></table> </div> <h2 class=\'KJEScheduleHeader KJEFontHeading\'>Payment Schedule</h2> **REPEATING GROUP** ';